# 业务逻辑漏洞

## 简述

攻击者利用业务的设计缺陷，获取敏感信息或破坏业务的完整性， 其本质就是程序逻辑输入管控不严，**没有对用户数据进行严格把控**，导致程序不能够正常处理或处理错误。



## 越权漏洞

**如果使用A用户的权限去操作B用户的数据，如果能够成功操作，则称之为越权操作**。 越权漏洞形成的原因是后台使用了不合理的权限校验规则导致的。一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方。

按照越权分类，可以分为**平行越权**和**垂直越权**。平行越权是指**同一权限下**，A用户可以操作B用户；垂直越权是指**不同权限下**，低权限A用户操作高权限B用户。

**攻击场景：**

- 水平越权-查看用户信息
- 水平越权-修改用户信息
- 水平越权-删除用户
- 垂直越权-未授权访问
- 垂直越权-查看管理员信息
- 垂直越权-修改管理员信息
- 垂直越权-删除管理员
- 垂直越权-提升管理员





## 支付漏洞

电商类网站在业务流程整个环节，需要对业务数据的完整性和一致性进行保护，特别是确保在用户客户端与服务、业务系统接口之间的数据传输的一致性，通常在订购类交易流程中，容易出现服务器端未对用户提交的业务数据进行强制校验，过度信赖客户端提交的业务数据而导致的商品金额篡改漏洞。商品金额篡改测试，通过抓包修改业务流程中的交易金额等字段，例如在支付页面抓取请求中商品的金额字段，修改成任意数额的金额并提交，查看能否以修改后的金额数据完成业务流程。 



**攻击场景：**

- 购买数量篡改
- 付款金额篡改



## 验证码

验证码机制主要用于用户身份识别，常见可分为图片验证码、数字验证码、滑动验证码、短信验证码、邮箱验证码等。服务端未对验证码的验证时间、次数作出限制，存在**爆破**的可能性。

**攻击场景：**

- 短信验证码横向轰炸
- 短信验证码纵向轰炸
- 短信验证码泄露
- 短信验证码不失效
- 短信验证码绕过
- 短信验证码写死



## 注册



**攻击场景：**

- 任意用户注册
- 用户覆盖
